---
title: "Introdução à linguagem R: <br><br>"
subtitle: "7 Análise de dados<br><br><br>"
author: "Maurício H. Vancine"
date: "14/01/2019"
output:
  xaringan::moon_reader:
    css: [metropolis]
    lib_dir: libs
    nature:
      #highlightStyle: github
      highlightLines: true
      countIncrementalSlides: true
    includes:
      in_header: header.html
---

```{r, setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```

class: clear, center, middle
background-image: url(https://raw.githubusercontent.com/mauriciovancine/curso-r/master/imagens/estatistica1.png)
background-size: 700px
background-position: 50% 50%

---

class: inverse, center, middle

# IMPORTANTE! Antes de eu falar qualquer coisa: **não sou estatístico**, **sou ecólogo** como vocês, mas que gosta muito de **Estatística** e vem trabalhando há algum tempo com essa ferramenta

---

class: inverse, center, middle

# Dito isso, posso ter cometido **algum erro conceitual**. Se o fiz, peço **desculpas antecipadamente** e espero sinceramente não os **prejudicar** futuramente

---

# 7 Análise de dados
## Tópicos
7.1 Estrutura geral de uma pesquisa
<br>
7.2 Método científico
<br>
7.3 População, amostra e variável
<br>
7.4 Tipos de variáveis
<br>
7.5 Tipos de análises: univariadas e multivariadas
<br>
7.6 Tipos de análises: descritivas e inferenciais
<br>
7.7 Análises explanatórias
<br>
7.8 Análises inferenciais
<br>
7.9 Análises inferenciais qualitativas
<br>
7.10 Tipos de análises: paramétricas e não-paramétricas
<br>
7.11 Análises inferenciais qualitativas

---

background-image: url(https://design.jet.com.br/editoraufv/Produto/5446740985_principios-de-estatistica-em-ecologia.jpg)
background-size: 250px
background-position: 50% 75%

# 7 Análise de dados

## Livros

### **Princípios Estatísticos em Ecologia (2004 [2011])** 

### Nicholas Gotelli e Aaron Ellison [Victor Landeiro]

<br><br><br><br><br><br><br><br><br><br><br>

[*] https://sites.google.com/site/vllandeiror/

---

background-image: url(https://images.livrariasaraiva.com.br/imagemnet/imagem.aspx/?pro_id=9748081&qld=90&l=430&a=-1=1004198474)
background-size: 230px
background-position: 50% 70%

# 7 Análise de dados

## Livros

### **Estatística Básica (2017)** 

### Wilton Bussab e Pedro Morettin

<br><br><br><br><br><br><br><br><br><br><br>

[*] https://www.ime.usp.br/~pam/scriptsR.html

---

background-image: url(https://images-na.ssl-images-amazon.com/images/I/51BnpHBDg-L._SX373_BO1,204,203,200_.jpg)
background-size: 250px
background-position: 50% 70%

# 7 Análise de dados

## Livros

### **A primer of ecological statistics (2012)** 

### Nicholas Gotelli e Aaron Ellison

<br><br><br><br><br><br><br><br><br><br><br>

[*] https://harvardforest.fas.harvard.edu/ellison/publications/primer/datafiles2e

---

background-image: url(https://images-na.ssl-images-amazon.com/images/I/41ZM0yCFzLL._SX350_BO1,204,203,200_.jpg)
background-size: 230px
background-position: 50% 70%

# 7 Análise de dados

## Livros

### **Analyzing Ecological Data (2007)** 

### Alain Zuur, Elena Ieno e Graham Smith

<br><br><br><br><br><br><br><br><br><br><br>

[*] http://highstat.com/index.php/analysing-ecological-data

---

background-image: url(https://images.springer.com/sgw/books/medium/9780387874579.jpg)
background-size: 200px
background-position: 50% 75%

# 7 Análise de dados

## Livros

### **Mixed Effects Models and Extensions in Ecology with R**<sup>*</sup>

### Alain Zuur, Elena Ieno, Neil Walker, Anatoly Saveliev e Graham Smith

<br><br><br><br><br><br><br><br><br>

[*] http://highstat.com/index.php/mixed-effects-models-and-extensions-in-ecology-with-r

---

background-image: url(https://qkstats.files.wordpress.com/2015/08/cover.jpg)
background-size: 250px
background-position: 50% 70%

# 7 Análise de dados

## Livros

### **Experimental Design and Data Analysis for Biologists (2002)** 

### Gerry Quinn e Michael Keough

<br><br><br><br><br><br><br><br><br><br><br>

[*] https://ms.mcmaster.ca/~bolker/emdbook/index.html

---

background-image: url(https://press.princeton.edu/sites/default/files/styles/large/public/covers/9780691125220_0.png?itok=3jLmBQjA)
background-size: 250px
background-position: 50% 70%

# 7 Análise de dados

## Livros

### **Ecological Models and Data in R (2008)**

### Ben Bolker

<br><br><br><br><br><br><br><br><br><br><br>

[*] https://ms.mcmaster.ca/~bolker/emdbook/index.html

---

background-image: url(https://radio.ufg.br/up/120/o/Thiago_Rangel.jpg)
background-size: 500px
background-position: 50% 75%

# 7 Análise de dados

## Sites

### **Estatística para Pesquisa Científica** 

### Prof. Thiago Rangel

<br><br><br><br><br><br><br><br><br><br><br>

[*] http://rangel.eco.br/index.html

---

background-image: url(http://www.noticias.uem.br/images_portal/stories/Isolde_site.jpg)
background-size: 500px
background-position: 50% 75%

# 7 Análise de dados

## Sites

### **Estatística para Pesquisa Científica** 

### Profa. Isolde Previdelli

<br><br><br><br><br><br><br><br><br><br><br>

[*] https://biostatistics-uem.github.io/Bio/index.html


---

background-image: url(https://raw.githubusercontent.com/mauriciovancine/curso-r/master/imagens/pesquisa.png)
background-size: 800px
background-position: 50% 50%

# 7.1 Estrutura geral de uma pesquisa

---

# 7.2 Método Científico

--

### **Indutivo**: chegar a uma **lei geral** por meio da observação de certos **casos particulares**

--

### **Dedutivo**: parte de **teorias e leis consideradas gerais** buscando explicar a ocorrência de **fenômenos particulares**

--

### **Hipotético-dedutivo**: 1. problema ou lacuna de conhecimento, 2. formulação de **hipóteses**, 3. inferência dedutiva (**teste das hipóteses** para os casos particulares - tentativa de **falseamento ou refutação**), 4. corroboração

--

### **Dialético**: leva em conta o constante movimento dos **fenômenos históricos-sociais** para o entendimento da totalidade

---

background-image: url(http://2.bp.blogspot.com/-w-hfWsfsPuY/T-fCEn_Os0I/AAAAAAAAAY0/WCRJuRxlQ_c/s1600/ciencia_e_religi%C3%A3o.jpg)
background-size: 500px
background-position: 50% 60%

# 7.2 Método Científico

## Filosofia da Ciência

---

# 7.2 Método Científico

## **Método hipotético-dedutivo**

### 1. problema ou lacuna de conhecimento
### 2. formulação de **hipóteses**
### 3. inferência dedutiva (**teste das hipóteses** para os casos particulares - tentativa de **falseamento ou refutação**)
### 4. corroboração

---

# 7.2 Método Científico

## **Método hipotético-dedutivo**

```{r, echo=FALSE, fig.align="center"}
plot(1:10,
     1:10,
     type = "l",
     col = "red",
     lwd = 5,
     mgp=c(1,1,0),
     bty = "l",
     xlab = "Variável preditora",
     ylab = "Variável resposta",
     cex.lab = 2.5,
     xaxt = "n",
     yaxt = "n"
     )
```

---

background-image: url(https://i2.wp.com/blog.mettzer.com/wp-content/uploads/2017/05/metodo-cientifico2.jpg?w=583&ssl=1)
background-size: 350px
background-position: 50% 80%

# 7.2 Método Científico

## **Método hipotético-dedutivo**

---

background-image: url(https://cnoanadiastc.files.wordpress.com/2010/01/metodo-cientifico-21.gif)
background-size: 500px
background-position: 50% 60%

# 7.2 Método Científico

## **Método hipotético-dedutivo**

---

background-image: url(https://1.bp.blogspot.com/-7ZhO35Gndpo/Vd3lkIcyaMI/AAAAAAAABSQ/Xs44DNNjMjc/s1600/Screen%2BShot%2B2015-08-26%2Bat%2B10.12.30%2BAM.png)
background-size: 400px
background-position: 50% 80%

# 7.2 Método Científico

## Ben Bolker

---


# 7.2 Método Científico

## Ben Bolker

.pull-left[
<img src="https://ms.mcmaster.ca/~bolker/bmb_glm.jpg" width=200 height=200>
]

.pull-right[
<img src="https://press.princeton.edu/sites/default/files/styles/large/public/covers/9780691125220_0.png?itok=3jLmBQjA">
]

<br><br><br><br><br><br><br><br><br><br><br><br><br><br>

[*] https://ms.mcmaster.ca/~bolker/emdbook/index.html

---

background-image: url(https://1.bp.blogspot.com/-7ZhO35Gndpo/Vd3lkIcyaMI/AAAAAAAABSQ/Xs44DNNjMjc/s1600/Screen%2BShot%2B2015-08-26%2Bat%2B10.12.30%2BAM.png)
background-size: 400px
background-position: 50% 80%

# 7.2 Método Científico

## Ben Bolker

---

background-image: url(http://agencia.fapesp.br/agencia-novo/imagens/noticia/28416.jpg)
background-size: 700px
background-position: 50% 80%

# 7.2 Método Científico

## **1. Pergunta**

### Como as **modificações da paisagem** (perda e fragmentação de habitat) afetam as comunidades de **anfíbios**?

---

background-image: url(https://cdn-images-1.medium.com/max/800/0*BZmrxsaQNeaFHdsT.)
background-size: 300px
background-position: 50% 90%

# 7.2 Método Científico

## **2. Coleta dos dados**

### Ir para campo, anotar e/ou medir diversas variáveis

### Caderno de campo, instrumentos, sorte, mosquitos, carrapatos....

---

background-image: url(https://marcoarmello.files.wordpress.com/2018/01/figura-1.png)
background-size: 500px
background-position: 50% 80%

# 7.2 Método Científico

## **2. Coleta [e organização] dos dados**

### Voltar do campo, com cadernos, planilhas, câmeras...

### Planilhar dados, visualizar fotos, identificar plantas, e café, muito, café...

---

# 7.2 Método Científico

## **3. Modelos estatísticos**
```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.align="center"}
library(tidyverse)
set.seed(1)
ggplot(data = data.frame(x = sort(runif(30, 0, 100)), y = sort(rpois(30, 10)))) +
  aes(x = x, y = y) +
  geom_point(size = 7, alpha = .5) +
  stat_smooth(method = "lm", size = 2) +
  xlim(0, 100) +
  labs(x = "Variável preditora",
       y = "Variável resposta") +
  theme_classic() +
  theme(axis.title = element_text(size = 24), 
        axis.text.x = element_text(size = 20),
        axis.text.y = element_text(size = 20))
```

---

# 7.2 Método Científico

## **3. Modelos estatísticos**

### E por que eu preciso fazer um **modelo estatístico**?

--

### É possível **coletar todos os dados** em campo?

--

## Nunca!

--

### Não há **recursos financeiros**, **tempo** ou **pessoal** para fazer **censos** em campo (salvo algumas exceções)

---

background-image: url(https://raw.githubusercontent.com/mauriciovancine/curso-r/master/imagens/populacao_estatistica.png)
background-size: 700px
background-position: 50% 80%

# 7.3 População, amostra e variável

### **População [estatística]**: consiste em **todos os elementos** (indivíduos, itens ou objetos) cujas características estejam **sendo estudadas**

---

background-image: url(https://raw.githubusercontent.com/mauriciovancine/curso-r/master/imagens/amostra.png)
background-size: 700px
background-position: 50% 80%

# 7.3 População, amostra e variável

### **Amostra**: é uma **parcela da população estatística**, selecionada para fins de estudo, que deve **mantém as características da população**

---

background-image: url(https://raw.githubusercontent.com/mauriciovancine/curso-r/master/imagens/variavel.png)
background-size: 700px
background-position: 40% 70%

# 7.3 População, amostra e variável

### **Variável [aleatória ou estatística]**: é uma **característica medida** sob o estudo, que assume **diferentes valores**

---

background-image: url(https://raw.githubusercontent.com/mauriciovancine/curso-r/master/imagens/modelos_estatisticos.png)
background-size: 700px
background-position: 50% 99%

# Relacionando as variáveis, teremos um...

--

### **Variável preditora [independente] (X)**: varia independentemente e é coletada com o intuito de explicar a variável resposta

--

### **Variável resposta [dependente] (Y)**: espera-se que varie, i.e., seja dependente, da(s) variável(is) preditoras

---

background-image: url(https://raw.githubusercontent.com/mauriciovancine/curso-r/master/imagens/ajuste_modelo.png)
background-size: 700px
background-position: 50% 70%

# ...modelo estatístico

### **Modelo estatístico**: é a tentativa de explicar a variação de **variáveis respostas (Y)** em função de **variáveis preditoras (X)**

---

class: inverse, center, middle

# E o que garante que podemos **concluir nossas hipóteses** a respeito da **população** a partir das **amostras**?

---

class: inverse, center, middle

# O **delineamento amostral**!!!

---

# Delineamento amostral

## Conjunto de **métodos e decisões** que garantam que a **amostra** seja **parte representativa** da **população estatística**

--

### Depende de:
1. Pergunta
2. Grupo de pesquisa
3. Métodos de amostragem (parcela, transecto, busca ativa, cameras, pitfall)
4. Área de amostragem
5. Tamanho da amostra
6. Esforço de amostragem
7. Autocorrelação espacial e temporal
8. Pseudo-réplica
<br>
...

---

background-image: url(https://oestatistico.com.br/wp-content/uploads/2016/09/Infer%C3%AAncia-o-estat%C3%ADstico.jpg)
background-size: 700px
background-position: 50% 70%

# Delineamento amostral e inferência

---

background-image: url(https://raw.githubusercontent.com/mauriciovancine/curso-r/master/imagens/amostragem.png)
background-size: 800px
background-position: 50% 70%

# Delineamento amostral e inferência

## Há **diversos pontos** que poderiamm ser amostrados

---

background-image: url(https://raw.githubusercontent.com/mauriciovancine/curso-r/master/imagens/amostragem_sel.png)
background-size: 800px
background-position: 50% 70%

# Delineamento amostral e inferência

### No entanto, amostramos o **máximo possível**, dentro das **limitações de recusos**, para "se aproximar" da **população estatística**

---

class: inverse, center, middle

# Dúvidas?

---

class: inverse, center, middle

# Uma vez **definida a pergunta**, **criadas as hipóteses** e **escolhido os métodos e delimeamento amostral**, como decidir a **análise estatística** mais indicada para **testar** as hipóteses?

---

background-image: url(https://raw.githubusercontent.com/mauriciovancine/curso-r/master/imagens/variables.png)
background-size: 800px
background-position: 50% 50%

# 7.4 Tipos de variáveis 

---

background-image: url(https://raw.githubusercontent.com/mauriciovancine/curso-r/master/imagens/graficos_variaveis.png)
background-size: 800px
background-position: 50% 50%

# 7.4 Tipos de variáveis (gráficos)

---

background-image: url(https://raw.githubusercontent.com/mauriciovancine/curso-r/master/imagens/analises_variaveis.png)
background-size: 800px
background-position: 50% 50%

# 7.4 Tipos de variáveis (análises estatísticas)

---

# 7.5 Tipos de análises: uni e multivariadas

### Conjunto de dados de `iris` fornece medidas em centímetros das variáveis comprimento e largura da sépala e pétala de 50 flores de 3 espécies *Iris setosa*, *Iris versicolor* e *Iris virginica*.

<br><br>

```{r}
head(iris)
```

---

# 7.5 Tipos de análises: uni e multivariadas

<br><br><br>

### **Univariadas**: análises explanatórias e inferenciais para apenas **uma variável resposta (Y<sub>1</sub>)**. Exemplos: Qui-quadrado, ANOVA, regressão linear, GLM, GAM

<br>

### **Multivariadas**: análises explanatórias e inferenciais para **duas ou mais variáveis resposta (Y<sub>1</sub>, Y<sub>2</sub>, Y<sub>3</sub>, ..., Y<sub>n</sub>)**. Exemplos: PCA, PCoA, agrupamentos, RDA, dbRDA

---

.pull-left[
<img src="https://raw.githubusercontent.com/mauriciovancine/curso-r/master/imagens/univariate.png" width=400 height=400>
]

.pull-right[
<img src="https://raw.githubusercontent.com/mauriciovancine/curso-r/master/imagens/multivariate.png" width=400 height=400>
]

# 7.5 Tipos de análises: uni e multivariadas

---

class: inverse, center, middle

# Focaremos apenas nas análises **univariadas**. Análises **multivariadas** ficam para uma próxima vez...

---

class: inverse, clear, middle

# Vamos importar alguns dados feitos para não dar errado...

---

background-image: url(https://octodex.github.com/images/octobiwan.jpg)
background-size: 250px
background-position: 50% 90%

# Dados do GitHub

## Vamos utilizar os dados que estão no meu **GitHub**


`https://github.com/mauriciovancine/curso-r/tree/master/data`


`dados_anfíbios.csv -> Raw -> Copia o link`

--

```{r, results = FALSE, message = FALSE}
da <- read_csv("https://raw.githubusercontent.com/mauriciovancine/curso-r/master/data/dados_anfibios.csv")
da
```

---

# Dados do GitHub

## Dados criados para abordar todas as análises estatísticas e ainda responder à pergunta inicial

--

### Como as **modificações da paisagem** (perda e fragmentação de habitat) afetam as comunidades de **anfíbios**?

--

```{r}
glimpse(da)
```

---

# 7.6 Análises: explanatórias e inferenciais

<br><br><br>

### **Explanatórias [Descritivas]**: **sumariza os dados** de forma quantitativa, de forma a **resumir as informações**, através de **tabelas de frequências**, **gráficos** e **medidas-resumo**

<br>

### **Inferenciais**: conjunto de técnicas para **tirar conclusões dos dados**, e.g., **teste de hipóteses**, para fazer **inferências para a população** da qual as amostras foram retiradas

---

# 7.7 Análises explanatórias

## **1 Tabelas de frequência**: resume variáveis qualitativas e quantitativas
```{r}
# tabela de frequencia - qualitativos
ta.fr <- da %>% 
  group_by(matriz) %>% 
  summarise(n_sp_fab = sum(n_sp), 
            n_flo_fab = sum(sp_flo), 
            n_sav_fab = sum(sp_sav)) %>% 
  mutate(n_sp_fre = (n_sp_fab / sum(n_sp_fab)) %>% round(2),
         n_flo_fre = (n_flo_fab / sum(n_flo_fab)) %>% round(2),
         n_sav_fre = (n_sav_fab / sum(n_sav_fab)) %>% round(2))
ta.fr
```

---

# 7.7 Análises explanatórias

## **2 Gráficos**: resume visualmente variáveis qualitativas e quantitativas
```{r}
# grafico de barras - qualitativos
ta.fr.gat <- ta.fr %>% 
  select(matriz, n_flo_fab, n_sav_fab) %>% 
  gather(key = sp_type, n_sp, n_flo_fab, n_sav_fab)
ta.fr.gat
```
  
---

# 7.7 Análises explanatórias

## **2 Gráficos**: resume visualmente variáveis qualitativas e quantitativas
```{r, eval=FALSE}
ggplot(data = ta.fr.gat) +
  aes(x = matriz, y = n_sp, fill = sp_type) +
    geom_bar(position = position_dodge(), stat = "identity") +
  labs(x = "Matriz",
       y = "Número de espécies",
       fill = "Espécies") +
  scale_fill_manual(labels = c("Floresta", "Savana"),
                    values = c("Forest green", "orange")) +
  geom_text(aes(label = n_sp), vjust = 1.5, size = 3.5,
             col = "white", position = position_dodge(0.9)) +
  theme_classic() +
  theme(axis.title = element_text(size = 24),
        axis.text.x = element_text(size = 20),
        axis.text.y = element_text(size = 20),
        legend.title = element_text(size = 14),
        legend.text = element_text(size = 12))
```

---

# 7.7 Análises explanatórias

## **2 Gráficos**
```{r, echo=FALSE, fig.align='center'}
# grafico de barras - qualitativos
ggplot(data = ta.fr.gat) +
  aes(x = matriz, y = n_sp, fill = sp_type) +
    geom_bar(position = position_dodge(), stat = "identity") +
  labs(x = "Matriz",
       y = "Número de espécies",
       fill = "Espécies") +
  scale_fill_manual(labels = c("Floresta", "Savana"),
                    values = c("Forest green", "orange")) +
  geom_text(aes(label = n_sp), vjust = 1.5, size = 5,
             col = "white", position = position_dodge(0.9)) +
  theme_classic() +
  theme(axis.title = element_text(size = 24),
        axis.text.x = element_text(size = 20),
        axis.text.y = element_text(size = 20),
        legend.title = element_text(size = 14),
        legend.text = element_text(size = 12))
```

---

# 7.7 Análises explanatórias

## **3 Medidas-resumo**: resume a valores *representativos* da série de dados

--

### **3.1 Medidas de posição**: média, mediana e moda

### **3.2 Medidas de dispersão**: variância e desvio padrão

### **3.3 Quantis**: p10, p25, p50, p75, p90

### **3.4 Simetria**: assimetria, curtose e transformações

---

# 7.7 Análises explanatórias

## **3.1 Medidas de posição**

### **3.1.1. Média aritmética**: soma das observações, dividido pelo número de observações
```{r}
# media
da %>% 
  select(pct_flo) %>%
  pull() %>% 
  mean()
```
--
```{r}
# media
mean(da$conect)
```

---

# 7.7 Análises explanatórias

## **3.1 Medidas de posição**

### **3.1.2 Mediana**: posição central das observações, quanto estão ordenadas em ordem crescente
```{r}
# mediana
da %>% 
  select(pct_flo) %>%
  pull() %>% 
  median()
```
--
```{r}
# mediana
median(da$conect)
```

---

# 7.7 Análises explanatórias

## **3.1 Medidas de posição**

### **3.1.3 Moda**: o elemento mais frequente das observações. Pode haver mais de uma moda, logo temos distribuições bimodais, trimodais...
```{r}
# moda
mo.pct <- da %>% 
  select(pct_flo) %>%
  pull()

names(table(mo.pct))[table(mo.pct) == max(table(mo.pct))]
```
--
```{r}
# moda
names(table(da$conect))[table(da$conect) == max(table(da$conect))]
```

---

# 7.7 Análises explanatórias

## **3.2 Medidas de dispersão**

### **3.2.1 Variância**: quantifca a variabilidade dos dados em torno da média
```{r}
# variancia
da %>% 
  select(pct_flo) %>%
  pull() %>% 
  var()
```
--
```{r}
# variancia
var(da$conect)
```

---

# 7.7 Análises explanatórias

## **3.2 Medidas de dispersão**

### **3.2.2 Desvio padrão**: Quantifca a variabilidade dos dados na mesma escala em que eles foram medidos
```{r}
# desvio padro
da %>% 
  select(pct_flo) %>%
  pull() %>% 
  sd()
```
--
```{r}
# desvio padro
sd(da$conect)
```

---

# 7.7 Análises explanatórias

### **3.3 Quantis**: medidas que dividem os dados ordenados crescentemente em um número de partes iguais. Outros nomes: percentis (1/100), decis (1/10) e quartis (1/4)
```{r}
# quantis
da %>% 
  select(pct_flo) %>%
  pull() %>% 
  quantile(probs = c(.05, .1, .25, .50, .75, .9, .99))
```
--
```{r}
# quantis
quantile(da$conect, probs = c(.05, .1, .25, .50, .75, .9, .99))
```

---

background-image: url(https://cdn-images-1.medium.com/max/1600/1*nj-Ch3AUFmkd0JUSOW_bTQ.jpeg)
background-size: 600px
background-position: 50% 80%

# 7.7 Análises explanatórias

### **3.4.1 Assimetria**: analisa a proximidade ou o afastamento de um conjunto de dados em relação à distribuição Gaussiana

<br>

- Se b<sub>1</sub> = 0, a distribuição é **simétrica**
- Se b<sub>1</sub> > 0, a distribuição **assimétrica a direita (positiva)**
- Se b<sub>1</sub> < 0, a distribuição **assimétrica a esquerda (negativa)**

---

# 7.7 Análises explanatórias

### **3.4.1 Assimetria**
```{r, eval=FALSE}
# pacote
install.packages("e1071")
```
--
```{r}
library(e1071)
```
--
```{r}
# assimetria
da %>% 
  select(pct_flo) %>%
  pull() %>% 
  skewness()

# assimetrica a esquerda
```

---

# 7.7 Análises explanatórias

### **3.4.1 Assimetria**
```{r}
mean(da$pct_flo)
median(da$pct_flo)
names(table(da$pct_flo))[table(da$pct_flo) == max(table(da$pct_flo))]
```
--
```{r}
# media < media < moda
```

---

# 7.7 Análises explanatórias

### **3.4.1 Assimetria**
.pull-left[
```{r plot1, eval=FALSE}
hist(da$pct_flo, 
     col = "gray50",
     prob = TRUE)
lines(density(da$pct_flo),
      lwd = 2,
      col = "red")
```
]

.pull-right[
```{r ref.label="plot1", echo=FALSE}
```
]

---

background-image: url(http://www.portalaction.com.br/sites/default/files/resize/EstatisticaBasica/figuras/curtose1-700x304.png)
background-size: 600px
background-position: 50% 90%

# 7.7 Análises explanatórias

### **3.4.2 Curtose**: caracteriza a forma da distribuição quanto ao seu achatamento

- Se b<sub>2</sub> < 0, a distribuição é **Platicúrtica**
- Se b<sub>2</sub> = 1, a distribuição é **Mesocúrtica**
- Se b<sub>2</sub> > 1, a distribuição é **Leptocúrtica**

---

# 7.7 Análises explanatórias

### **3.4.2 Curtose**
```{r}
# assimetria
da %>% 
  select(pct_flo) %>%
  pull() %>% 
  kurtosis()
# platicurtica
```

---

# 7.7 Análises explanatórias

### **3.4.2 Curtose**
.pull-left[
```{r plot2, eval=FALSE}
hist(da$pct_flo, 
     col = "gray50",
     prob = TRUE)
lines(density(da$pct_flo),
      lwd = 2,
      col = "red")
```
]

.pull-right[
```{r ref.label="plot2", echo=FALSE}
```
]

---

class: inverse, center, middle

# Dúvidas?

---

# 7.8 Análises inferenciais 

## **Teste de hipóteses**

### H<sub>0</sub>: hipótese nula - sem efeito

### H<sub>1</sub>: hipótese alternativa - existe efeito

--

### Sempre testamos se a **H<sub>0</sub>** é **verdadeira**, se for, não há efeito e paramos de analisar, concluindo que nossa **H<sub>1</sub>** não pode ser **corroborada**

--

### No entanto, se podemos rejeitar a **H<sub>0</sub>** com um **erro muito pequeno** (digamos, < 5%), podemos assumir que **H<sub>1</sub>** é verdadeira e explica o fato que estamos observando

---

# Princípio da parcimônia

## **Princípio da parcimônia**: a explicação **mais simples** é sempre a **mais plausível**

--

### **A parsimonious view of the parsimony principle in ecology and evolution**
Marco Túlio P. Coelho <br>
José Alexandre Diniz‐Filho <br>
Thiago F. Rangel <br>
<br>
Ecography 2018

--

background-image: url(https://wol-prod-cdn.literatumonline.com/cms/attachment/43380c30-360c-4ebf-b0cd-99f3cdb11f0c/ecog12385-fig-0001-m.jpg)
background-size: 380px
background-position: 78% 85%

<br><br><br><br>

[*] https://doi.org/10.1111/ecog.04228

---

# 7.8 Análises inferenciais 

## **Teste de hipóteses**

### **Dois erros** podem ser cometidos ao se realizar um **teste de hipóteses**:

--

### 1. **Rejeitar** a hipótese H<sub>0</sub>, quando tal hipótese é **verdadeira**

--

### 2. **Não rejeitar** a hipótese H<sub>0</sub>, quando ela deveria **ser rejeitada**

--
<br>
### **P(Erro Tipo I) = P(rejeitar H<sub>0</sub>|H<sub>0</sub> é verdadeira) = α**
### P(Erro Tipo II) = P(não rejeitar H<sub>0</sub>|H<sub>0</sub> é falsa) = β
### Poder do teste = P(Rejeitar H<sub>0</sub>|H<sub>0</sub> é falsa) = 1 − β

---

background-image: url(https://9001b62c-a-62cb3a1a-s-sites.googlegroups.com/site/ecolsampling/introestatistica/teste-de-hipotese/Erros%20estatisticos.png?attachauth=ANoY7coj1QBdgZk-6Bl5g3EpESguwKL4l_6YV7WYJoplc_8Q9VadblDYbo3kHUmmulb4i_F2T0LNavCfchw6dCyNMHPdgEu9ptiHCd_Q4YHmnq1n86fVXhcv9xpLSOOM6xbsJQrvbEkRoi44j7d2wPtHiedm9WuCtTXFy-7okEpg5Qm0DBoodJm6Ooz6pHPJNptR2VtX6lBdjTzpBcUwpdHr-Xc6RI4q-EUxa2tRhm6E-0I6gaROk0oG5m-BFwWzWyRxPhObjYR6VzHQ7US2eMD6xir9rsQsJQ%3D%3D&attredirects=0)
background-size: 700px
background-position: 50% 65%

# 7.8 Análises inferenciais 

## **Teste de hipóteses**

---

class: inverse, center, middle

# Alguém sabe de algum **valor interessante**, para assumir ao **valor de α**, para ter uma chance muito pequena de cometer o **erro tipo I**, i.e., **rejeitar H<sub>0</sub>**, quando a **H<sub>0</sub>** é **verdadeira**?

---

class: inverse, center, middle

# Que tal **α = 0.05**?

---

class: inverse, center, middle
background-image: url(https://media.giphy.com/media/xT77XWum9yH7zNkFW0/giphy.gif)
background-size: 800px

---

background-image: url(https://raw.githubusercontent.com/mauriciovancine/curso-r/master/imagens/p_value.png)
background-size: 800px
background-position: 50% 65%

# 7.8 Análises inferenciais 

## **Valor de p < 0.05**

---

# 7.8 Análises inferenciais 

## **Valor de p < 0.05**

--

### **Probabilidade**: integral de toda a função de **distribuição de probabilidade** (f.d.p) = 1.00

--

### Iniciando a integral do **valor crítico da estatística** (Z, F, X<sup>2</sup>, que é calculado à partir dos dados coletados) ao infinito, o resultado é a área abaixo da curva, que reslta no valor de **p**

--

### Assumindo **α = 0.05**, só podemos **rejeitar a H<sub>0</sub>** se a área, i.e., a probabilidade for **p < 0.05**

---

# 7.8 Análises inferenciais 

## **Valor de p < 0.05**

### Dessa forma, se **p < 0.05**, tenho uma **chance** (probabilidade) menor que 5% de cometer o erro de:

<br><br><br>

## **rejeitar H<sub>0</sub>**, quando **H<sub>0</sub>** é **verdadeira**

---

class: inverse, center, middle

# O **α = 0.05** é fixo?

---

class: inverse, center, middle

# Posso utilizar **α = 0.01**?

---

class: inverse, center, middle

# E **α = 0.10**?

---

class: inverse, center, middle

# Tudo irá depender da sua pergunta e do risco que pode/quer correr ao cometer o erro de: **rejeitar H<sub>0</sub>** quando **H<sub>0</sub>** é **verdadeira**!

---

class: inverse, center, middle

# Dúvidas?

---

class: inverse, center, middle

# Com o que **sabemos até o momento**, podemos realizar um dos **testes mais simples em Ecologia**: o qui-quadrado

---

# 7.9 Análises inferenciais qualitativas

## **Qui-quadrado**

## **Pergunta** 
### Há diferença no número de espécies de anfíbios coletados em fragmentos rodeados por diferentes tipos de matrizes?

--

## **Hipóteses**
### **H<sub>0</sub>**: não há diferença
### **H<sub>1</sub>**: há diferença

---

background-image: url(https://www.researchgate.net/profile/Joao_Carrico/publication/51163921/figure/fig10/AS:341864759742465@1458518318112/Contingency-table-CT-nij-denotes-the-number-of-objects-that-are-common-to-clusters-Ai_W640.jpg)
background-size: 500px
background-position: 50% 85%

# 7.9 Análises inferenciais qualitativas

## **Qui-quadrado**: Dados de contagem
### **Tabela de contingência** que contabiliza a quantidade de espécies de floresta e savana em cada matriz de amostragem

---

# 7.9 Análises inferenciais qualitativas

## **Qui-quadrado**

### Formato dos dados
```{r}
da.chi <- da %>% 
  group_by(matriz) %>% 
  summarise(n_flo_fab = sum(sp_flo), 
            n_sav_fab = sum(sp_sav)) %>% 
  as.data.frame()
da.chi
```

---

# 7.9 Análises inferenciais qualitativas

## **Qui-quadrado**

### Formato dos dados
```{r}
# nomear as linhas colunas
row.names(da.chi) <- da.chi$matriz
da.chi
```
---

# 7.9 Análises inferenciais qualitativas

## **Qui-quadrado**

### Formato dos dados
```{r}
# retirar a primeira coluna
da.chi <- da.chi[, -1]
da.chi
```

---

# 7.9 Análises inferenciais qualitativas

## **Qui-quadrado**

### Análise - função `chisq.test`

```{r}
# chi quadrado
mo.chi <- chisq.test(da.chi)
mo.chi
```
---

# 7.9 Análises inferenciais qualitativas

## **Qui-quadrado**

### Tabela de dados 
```{r}
# tabela observada
da.chi


# tabela esperada
mo.chi$expected
```

---

# 7.9 Análises inferenciais qualitativas

## **Qui-quadrado**

### Gráfico
```{r}
ggplot(data = ta.fr.gat) +
  aes(x = matriz, y = n_sp, fill = sp_type) +
  geom_bar(position = position_dodge(), stat = "identity") +
  labs(x = "Matriz", y = "Número de espécies", fill = "Espécies") +
  scale_fill_manual(labels = c("Floresta", "Savana"),
                    values = c("Forest green", "orange")) +
  geom_text(aes(label = n_sp), vjust = 1.5, size = 65,
             col = "white", position = position_dodge(0.9)) +
  theme_classic() +
  annotate("text", label = "X-squared = 5.07, df = 2, p-value = 0.08", 
           size = 6, x = 2, y = 50) +
  theme(axis.title = element_text(size = 24),
        axis.text.x = element_text(size = 20),
        axis.text.y = element_text(size = 20),
        legend.title = element_text(size = 14),
        legend.text = element_text(size = 12))
```

---

# 7.9 Análises inferenciais qualitativas

## **2 Gráficos**
```{r, echo=FALSE, fig.align='center'}
# grafico de barras - qualitativos
ggplot(data = ta.fr.gat) +
  aes(x = matriz, y = n_sp, fill = sp_type) +
  geom_bar(position = position_dodge(), stat = "identity") +
  labs(x = "Matriz", y = "Número de espécies", fill = "Espécies") +
  scale_fill_manual(labels = c("Floresta", "Savana"),
                    values = c("Forest green", "orange")) +
  geom_text(aes(label = n_sp), vjust = 1.5, size = 5,
             col = "white", position = position_dodge(0.9)) +
  theme_classic() +
  annotate("text", label = "X-squared = 5.07, df = 2, p-value = 0.08", 
           size = 6, x = 2, y = 50) +
  theme(axis.title = element_text(size = 24),
        axis.text.x = element_text(size = 20),
        axis.text.y = element_text(size = 20),
        legend.title = element_text(size = 14),
        legend.text = element_text(size = 12))
```

---

class: inverse, center, middle

# Dúvidas?

---

# 7.9 Análises inferenciais quantitativas

## Pressuposto

<br><br><br>

### **Normalidade**: distribuição normal da **variável resposta (Y)**

--

### As análises de pressupostos são sempre em relação à **variável resposta (Y)**!

---

class: inverse, center, middle

# Dúvida: como deve ser a distribuição da **variável preditora (X)**?

---

# Distribuição da variável preditora

## A variável preditora deve ter **distribuição uniforme**

<br><br><br><br><br>

### Numa análise em que a **variável preditora (X)** é **contínua**, deve haver um **gradiente de variabilidade**, sendo que todos os valores devem ter a **mesma frequência aproximada**

---

# Distribuição da variável preditora

## **Distribuição uniforme**
.pull-left[
```{r plot3, eval=FALSE}
# distribuição uniforme
hist(
  runif(20, 0, 100), 
  col = "gray",
  main = "",
  xlab = "X")
```
]

.pull-right[
```{r ref.label="plot3", echo=FALSE}
```
]

---

# 7.9 Análises inferenciais quantitativas

## Teste de normalidade

<br><br>

### A **suposição de normalidade dos dados** amostrais é uma **condição exigida** para a realização de muitas inferências válidas a respeito de **parâmetros populacionais**

<br>
--

### Vários **métodos de estimação** e **testes de hipóteses** foram formulados sob a **suposição** de que a **amostra aleatória** tenha sido extraída de uma **população gaussiana**

---

# 7.9 Análises inferenciais quantitativas

## Tipo de análises

<br><br>

### **Análises paramétricas**: para dados com distribuição gaussiana, usa **parâmetros**

<br><br>

--

### **Análises não-paramétricas**: para dados sem distribuição gaussiana, usa **ranques** (ordena os valores e usa suas posições)

---

background-image: url(https://www.inf.ufsc.br/~andre.zibetti/probabilidade/figures/normal.PNG)
background-size: 800px
background-position: 50% 65%

# 7.9 Análises inferenciais quantitativas

## Distribuição Normal ou Gaussiana

---

# 7.9 Análises inferenciais quantitativas

## Teste de Shapiro-Wilk

### **H<sub>0</sub>**: os dados seguem uma distribuição gaussiana

--

### Então, se **p > 0.05**, os dados seguem uma **distribuição gaussiana**!
```{r}
shapiro.test(da$n_sp)
```

---

# 7.9 Análises inferenciais quantitativas

## Verificação gráfica: distribuição de densidade

```{r, fig.align='center', fig.width=6, fig.height=6}
plot(density(da$n_sp), ylab = "Densidade", 
     xlab = "Número de espécies", main = "")
```

---

# 7.9 Análises inferenciais quantitativas

## Verificação gráfica: qqplot

```{r, fig.align='center', fig.width=6, fig.height=6}
qqnorm(da$n_sp)
qqline(da$n_sp)
```

---

# 7.9 Análises inferenciais quantitativas

## Verificação gráfica: qqplot

```{r, message=FALSE, warning=FALSE, fig.align='center', fig.width=6, fig.height=6}
library(car)
qqPlot(da$n_sp, pch = 20, dist = "norm", envelope = .95)
```

---

# 7.9 Análises inferenciais quantitativas

## Teste de normalidade

### E se não tiver distribui normal?

--

### Transformações:

`log, log10, sqrt, ....`

---

# 7.9 Análises inferenciais quantitativas

## Teste de Shapiro-Wilk

### Então, se **p > 0.05**, os dados seguem uma **distribuição gaussiana**!
```{r}
y <- c(1, 2, 2, 3, 3, 3, 4, 5, 5, 2, 12, 8)
shapiro.test(y)
```

---

# 7.9 Análises inferenciais quantitativas

## Teste de Shapiro-Wilk **com log**

### Então, se **p > 0.05**, os dados seguem uma **distribuição gaussiana**!
```{r}
y.log <- log(c(1, 2, 2, 3, 3, 3, 4, 5, 5, 2, 12, 8))
shapiro.test(y.log)
```

---

# 7.9 Análises inferenciais quantitativas

### Verificação gráfica: distribuição de densidade

```{r, fig.align='center', fig.width=6, fig.height=6}
plot(density(y), ylab = "Densidade", 
     xlab = "Y", main = "")
```

---

# 7.9 Análises inferenciais quantitativas

### Verificação gráfica: distribuição de densidade

```{r, fig.align='center', fig.width=6, fig.height=6}
plot(density(y.log), ylab = "Densidade", 
     xlab = "Y", main = "")
```

---

# 7.9 Análises inferenciais quantitativas

### Verificação gráfica: qqplot

```{r, fig.align='center', fig.width=6, fig.height=6}
qqnorm(y)
qqline(y)
```

---

# 7.9 Análises inferenciais quantitativas

### Verificação gráfica: qqplot

```{r, fig.align='center', fig.width=6, fig.height=6}
qqnorm(y.log)
qqline(y.log)
```

---

# 7.9 Análises inferenciais quantitativas

### Verificação gráfica: qqplot

```{r, message=FALSE, warning=FALSE, fig.align='center', fig.width=6, fig.height=6}
library(car)
qqPlot(y, pch = 20, dist = "norm", envelope = .95)
```

---

# 7.9 Análises inferenciais quantitativas

### Verificação gráfica: qqplot

```{r, message=FALSE, warning=FALSE, fig.align='center', fig.width=6, fig.height=6}
library(car)
qqPlot(y.log, pch = 20, dist = "norm", envelope = .95)
```

---

# 7.9 Análises inferenciais quantitativas

## Teste de Shapiro-Wilk

### E se a transformação não resolver?
```{r}
set.seed(1)
y <- rpois(100, 5)
shapiro.test(y)
```

---

# 7.9 Análises inferenciais quantitativas

## Teste de Shapiro-Wilk **com log**

### E se a transformação não resolver?
```{r}
set.seed(1)
y.log <- log(rpois(100, 5))
shapiro.test(y.log)
```

---

class: inverse, middle, center

# Aí parte-se para **análises não-paramétricas**, que **não levam em condideração os valores**, mas sim as **posições dos valores** num ranqueamento

---

class: inverse, middle, center

# Dúvidas?

---

# 7.10 Análises inferenciais quantitativas

## **ANOVA: análise de variância**

## **Pergunta** 
### Há diferença no tamanho do fêmur de anfíbios coletados em paisagens com diferentes tipos de predominância de matrizes?

--

## **Hipóteses**
### **H<sub>0</sub>**: não há diferença
### **H<sub>1</sub>**: há diferença

---

background-image: url(https://raw.githubusercontent.com/mauriciovancine/curso-r/master/imagens/anova.png)
background-size: 500px
background-position: 50% 85%

# 7.10 Análises inferenciais quantitativas

## **ANOVA**: dados contínuos no Y e categóricos no X
### **Duas colunas**: X - variável qualitativa nominal ou ordinal; e Y - quantitativa medidas ou contagens

---

# 7.10 Análises inferenciais quantitativas

## **ANOVA**: 5 pontos importantes

### 1. ANOVA com uma variável preditora (X) com dois fatores (aqui valores que essa variável assume - e.g., **alto** e **baixo**) é chamada de `test-t`, com uma função específica no R
```{r}
t.test(tam_medio_femur ~ matriz,
       data = da %>%  filter(matriz %in% c("cana",  "pasto")))
```

---

# 7.10 Análises inferenciais quantitativas

## **ANOVA**: 5 pontos importantes

### 2. ANOVA com uma variável preditora (X) com mais de dois fatores é realizada em duas etapas: **a priori** (para ver se há diferença entre os grupos) e **a posteriori** (para saber qual é essa diferença), usando as funções `aov` e `TukeyHSD()`
```{r}
# a priori
aov.anf <- aov(tam_medio_femur ~ matriz,
               data = da)

summary(aov.anf)
```

---

# 7.10 Análises inferenciais quantitativas

## **ANOVA**: 5 pontos importantes
```{r}
# a posteriori
TukeyHSD(aov.anf)
```

---

# 7.10 Análises inferenciais quantitativas

## **ANOVA**: 5 pontos importantes
```{r, eval=FALSE, fig.align='center'}
# plot
ggplot(da) +
  aes(x = matriz, y = tam_medio_femur) +
  geom_boxplot(size = 1, color = c("orange", "blue", "forest green")) +
  geom_jitter(aes(color = matriz), width = .3, size = 4, alpha = .5) +
  scale_color_manual(values = c("orange", "blue", "forest green")) +
  labs(x = "Matriz",
       y = "Tamanho do fêmur") +
  theme_classic() +
    theme(axis.title = element_text(size = 24),
        axis.text.x = element_text(size = 20),
        axis.text.y = element_text(size = 20),
        legend.title = element_text(size = 18),
        legend.text = element_text(size = 16))
```

---

# 7.10 Análises inferenciais quantitativas

## **ANOVA**: 5 pontos importantes
```{r, echo=FALSE, fig.align='center'}
# plot
ggplot(da) +
  aes(x = matriz, y = tam_medio_femur) +
  geom_boxplot(size = 1, color = c("orange", "blue", "forest green")) +
  geom_jitter(aes(color = matriz), width = .3, size = 4, alpha = .5) +
  scale_color_manual(values = c("orange", "blue", "forest green")) +
  labs(x = "Matriz",
       y = "Tamanho do fêmur") +
  theme_classic() +
    theme(axis.title = element_text(size = 24),
        axis.text.x = element_text(size = 20),
        axis.text.y = element_text(size = 20),
        legend.title = element_text(size = 18),
        legend.text = element_text(size = 16))
```

---

# 7.10 Análises inferenciais quantitativas

## **ANOVA**: 5 pontos importantes

### 3. Deve-se atentar para a **independência das medidas**: as medidas podem ser **pareadas** ou **medidas repetidas** (mesmas pessoas entrevistadas antes da sessão de cinema e depois) ou **não pereadas** ou **medidas não repetidas** (pessoas diferentes)
```{r}
t.test(tam_medio_femur ~ matriz,
       data = da %>%  filter(matriz %in% c("cana", "pasto")),
       paired = TRUE)
```

---

background-image: url(https://statistics.laerd.com/statistical-guides/img/levels-explanation.gif)
background-size: 600px
background-position: 50% 75%

# 7.10 Análises inferenciais quantitativas

## **ANOVA**: 5 pontos importantes

---

# 7.10 Análises inferenciais quantitativas

## **ANOVA**: 5 pontos importantes

### 4. Se a distribuição da **variável resposta (Y)** é normal ou não. Isso implicará em vários testes diferentes, dependendo do **número de fatores** e do **pareamento das medidas**

---

background-image: url(https://raw.githubusercontent.com/mauriciovancine/curso-r/master/imagens/tipos_anova.png)
background-size: 600px
background-position: 50% 65%

# 7.10 Análises inferenciais quantitativas

## **ANOVA**: 5 pontos importantes

---

background-image: url(https://assets.cambridge.org/97805215/56965/cover/9780521556965.jpg)
background-size: 200px
background-position: 50% 65%

# 7.10 Análises inferenciais quantitativas

## **ANOVA**: Livro

### **Experiments in Ecology: Their Logical Design and Interpretation Using Analysis of Variance (2012)** 

### A. J. Underwood

<br><br><br><br><br><br><br><br>

[*] https://www.cambridge.org/core/books/experiments-in-ecology/DCF3663D5E7C9923D19B5ECE88167780

---

# 7.10 Análises inferenciais quantitativas

## **ANOVA**: 5 pontos importantes

### 5. Pressuposto da homocedasticidade: os erros têm de ter **variância comum**. Isso implica que cada tratamento que se está sendo comparado pelo teste F, deve ter aproximadamente a **mesma variância** para que a **ANOVA tenha validade**
```{r}
# anova
aov.anf <- aov(tam_medio_femur ~ matriz,
               data = da)
summary(aov.anf)
```

---

# 7.10 Análises inferenciais quantitativas

## **ANOVA**: 5 pontos importantes
```{r, fig.align='center'}
boxplot(aov.anf$res ~ da$matriz, col = "gray")
```

---

# 7.10 Análises inferenciais quantitativas

## **ANOVA**: 5 pontos importantes

### Teste de Bartlett

### **H<sub>0</sub>**: não há diferença entre as variâncias, i.e, há homogeneidade das variâncias ou ainda homocedasticidade
```{r}
bartlett.test(aov.anf$res ~ da$matriz)
```

---

class: inverse, center, middle

# Dúvidas de ANOVA?

---

# 7.11 Análises inferenciais quantitativas

## **Regressão linear: simples e múltipla**

## **Pergunta** 
### O tamanho do fêmur de anfíbios coletados em paisagens mais fragmentadas tende a ser maior do que de anfíbios de paisagens contínuas?

--

## **Hipóteses**
### **H<sub>0</sub>**: o tamanho não varia
### **H<sub>1</sub>**: o tamanho varia

---

background-image: url(https://raw.githubusercontent.com/mauriciovancine/curso-r/master/imagens/linear.png)
background-size: 500px
background-position: 50% 85%

# 7.11 Análises inferenciais quantitativas

## **Regressão linear: simples e múltipla**

### **Duas ou mais colunas**: X<sub>1</sub> + X<sub>2</sub> - variáveis quantitativas de medidas ou contagens; e Y - variável quantitativa de medidas ou contagens

---

background-image: url(https://learningstatisticswithr.com/book/lsr_files/figure-html/regression0-1.png)
background-size: 700px
background-position: 50% 75%

# 7.11 Análises inferenciais quantitativas

## **Regressão linear simples**

---

background-image: url(https://learningstatisticswithr.com/book/lsr_files/figure-html/regression1a-1.png)
background-size: 700px
background-position: 50% 75%

# 7.11 Análises inferenciais quantitativas

## **Regressão linear simples**

---

background-image: url(https://learningstatisticswithr.com/book/lsr_files/figure-html/regression1b-1.png)
background-size: 700px
background-position: 50% 75%

# 7.11 Análises inferenciais quantitativas

## **Regressão linear simples**

---

background-image: url(https://learningstatisticswithr.com/book/lsr_files/figure-html/regression3a-1.png)
background-size: 700px
background-position: 50% 75%

# 7.11 Análises inferenciais quantitativas

## **Regressão linear simples**

---

background-image: url(https://learningstatisticswithr.com/book/lsr_files/figure-html/regression3b-1.png)
background-size: 700px
background-position: 50% 75%

# 7.11 Análises inferenciais quantitativas

## **Regressão linear simples**

---

background-image: url(https://raw.githubusercontent.com/mauriciovancine/curso-r/master/imagens/reta.png)
background-size: 700px
background-position: 60% 75%

# 7.11 Análises inferenciais quantitativas

## **Regressão linear simples**

### Equação geral da reta

---

background-image: url(https://learningstatisticswithr.com/book/lsr_files/figure-html/regression3a-1.png)
background-size: 450px
background-position: 50% 95%

# 7.11 Análises inferenciais quantitativas

## **Regressão linear simples**

### Parâmetros estimados através do **Método dos Mínimos Quadrados (MMQ)**

Encontra o **melhor ajuste** para um conjunto de dados **tentando minimizar** a soma dos quadrados das diferenças entre o **valor estimado** e os **dados observados**

---

# 7.11 Análises inferenciais quantitativas

## **Regressão linear simples**
```{r}
# modelo linear simples
mo.lm <- lm(tam_medio_femur ~ pct_flo,
            data = da)
mo.lm
```

---

# 7.11 Análises inferenciais quantitativas

## **Regressão linear simples**
### 1. Parâmetros e testes-t dos parâmetros

```{r}
# resumo
summary(mo.lm)$coefficients
```

---

# 7.11 Análises inferenciais quantitativas

## **Regressão linear simples**
### 2. Parâmetros dos modelo (F, df e p)
```{r}
# resumo
summary(mo.lm)$fstatistic
summary(mo.lm)$df[2]
summary(mo.lm)$coefficients[2,4]
```

---

# 7.11 Análises inferenciais quantitativas

## **Regressão linear simples**
### 3. Coeficiente de determinação (R<sup>2</sup>) - 0 a 1 - porcentagem de explicação
```{r}
# resumo
summary(mo.lm)$r.squared
```

---

# 7.11 Análises inferenciais quantitativas

## **Regressão linear simples**
```{r, eval=FALSE, fig.align='center'}
plot(tam_medio_femur ~ pct_flo, 
     data = da,
     pch = 20,
     cex = 3)
abline(mo.lm, lwd = 2, col = "red")
```

---

# 7.11 Análises inferenciais quantitativas

## **Regressão linear simples**
```{r, echo=FALSE, fig.align='center'}
plot(tam_medio_femur ~ pct_flo, 
     data = da,
     pch = 20,
     cex = 3)
abline(mo.lm, lwd = 2, col = "red")
```

---

# 7.11 Análises inferenciais quantitativas

## **Regressão linear simples**
```{r, eval=FALSE, fig.align='center'}
ggplot(data = da) +
  aes(x = pct_flo, y = tam_medio_femur) +
  geom_point(shape = 21, size = 5, col = "black", fill = "forestgreen") +
  stat_smooth(method = "lm", col = "black", level = .95) +
  theme_classic() +
  labs(x = "Porcentagem de floresta (%)",
          y = "Tamanho do fêmur") +
  theme(axis.title = element_text(size = 24),
        axis.text.x = element_text(size = 20),
        axis.text.y = element_text(size = 20),
        legend.title = element_text(size = 14),
        legend.text = element_text(size = 12))
```

---

# 7.11 Análises inferenciais quantitativas

## **Regressão linear simples**
```{r, echo=FALSE, fig.align='center'}
ggplot(data = da) +
  aes(x = pct_flo, y = tam_medio_femur) +
  geom_point(shape = 21, size = 5, col = "black", fill = "forestgreen") +
  stat_smooth(method = "lm", col = "black", level = .95) +
  theme_classic() +
  labs(x = "Porcentagem de floresta (%)",
          y = "Tamanho do fêmur") +
  theme(axis.title = element_text(size = 24),
        axis.text.x = element_text(size = 20),
        axis.text.y = element_text(size = 20),
        legend.title = element_text(size = 14),
        legend.text = element_text(size = 12))
```

---

class: inverse, center, middle

# Retomando...

---

background-image: url(https://octodex.github.com/images/octobiwan.jpg)
background-size: 250px
background-position: 50% 90%

# Dados do GitHub

## Dados do **GitHub**


`https://github.com/mauriciovancine/curso-r/tree/master/data`


`dados_anfíbios.csv -> Raw -> Copia o link`

```{r, results = FALSE, message = FALSE}
library(tidyverse)

da <- read_csv("https://raw.githubusercontent.com/mauriciovancine/curso-r/master/data/dados_anfibios.csv")
da
```

---

class: inverse, center, middle

# Qui-quadrado

---

# 7.9 Análises inferenciais qualitativas

## **Qui-quadrado**

### Formato dos dados
```{r}
da.chi <- da %>% 
  group_by(matriz) %>% 
  summarise(n_flo_fab = sum(sp_flo), 
            n_sav_fab = sum(sp_sav)) %>% 
  as.data.frame()
da.chi
```

---

# 7.9 Análises inferenciais qualitativas

## **Qui-quadrado**

### Formato dos dados
```{r}
# nomear as linhas colunas
row.names(da.chi) <- da.chi$matriz
da.chi
```
---

# 7.9 Análises inferenciais qualitativas

## **Qui-quadrado**

### Formato dos dados
```{r}
# retirar a primeira coluna
da.chi <- da.chi[, -1]
da.chi
```

---

# 7.9 Análises inferenciais qualitativas

## **Qui-quadrado**

### Análise - função `chisq.test`

```{r}
# chi quadrado
mo.chi <- chisq.test(da.chi)
mo.chi
```
---

# 7.9 Análises inferenciais qualitativas

## **Qui-quadrado**

### Tabela de dados 
```{r}
# tabela observada
da.chi
```
--
```{r}
# tabela esperada
mo.chi$expected
```

---

# Cálculo dos valores:
```{r}
# primeiro valor da tabela esperada
(sum(da.chi[1, ]) * sum(da.chi[, 1])) / sum(rowSums(da.chi))
```
--
```{r}
# segundo valor da tabela esperada
(sum(da.chi[1, ]) * sum(da.chi[, 2])) / sum(colSums(da.chi))
```

---

class: inverse, center, middle

# Regressão linear

---

# 7.11 Análises inferenciais quantitativas

## **Regressão linear simples**
```{r}
# modelo linear simples
mo.lm <- lm(tam_medio_femur ~ pct_flo,
            data = da)
mo.lm
```

---

# 7.11 Análises inferenciais quantitativas

## **Regressão linear simples**
### Resumo do modelo

```{r}
# resumo
summary(mo.lm)
```

---

class: inverse, center, middle

# Vamos usar tidyverse aqui também!

---

class: clear, center, middle
background-image: url(https://www.rstudio.com/wp-content/uploads/2014/04/broom.png)
background-size: 400px
background-position: 50% 50%

---

# 7.11 Análises inferenciais quantitativas

## **Regressão linear simples**
```{r}
# parametros
library(broom)
tidy(mo.lm)
```

---

# 7.11 Análises inferenciais quantitativas

## **Regressão linear simples**
```{r}
# valores ajustados e residuos
augment(mo.lm)
```

---

# 7.11 Análises inferenciais quantitativas

## **Regressão linear simples**
```{r}
# coeficiente de determinacap
glance(mo.lm)
```

---

# 7.11 Análises inferenciais quantitativas

## **Diagnóstico da regressão**
### 1 Os resíduos precisam ter **distribuição normal**, com média 0 e desvio padrao 1
```{r}
# distribuição normal dos residuos
mean(mo.lm$residuals)
sd(mo.lm$residuals)
```

---

# 7.11 Análises inferenciais quantitativas

## **Diagnóstico da regressão**
```{r}
# distribuição normal dos residuos
shapiro.test(mo.lm$residuals)
```

---

# 7.11 Análises inferenciais quantitativas

## **Diagnóstico da regressão**
```{r, fig.align='center', fig.dim=c(6,6)}
# distribuição normal dos residuos
plot(density(mo.lm$residuals))
```

---

# 7.11 Análises inferenciais quantitativas

## **Diagnóstico da regressão**
```{r, fig.align='center', fig.dim=c(5,5)}
# qqplot
library(car)
qqPlot(mo.lm$residuals)
```

---

# 7.11 Análises inferenciais quantitativas

## **Diagnóstico da regressão**
### 2 A variância dos resíduos é homogênea ao longo de X
```{r, fig.align='center', fig.dim=c(5,5)}
# distribuição normal dos resíduos
plot(da$pct_flo, mo.lm$residuals)
abline(h = 0, col = "red")
```

---

class: inverse, center, middle

# Podemos fazer algumas transformações na variável Y e reanalizar o modelo, porém...

---

# 7.11 Análises inferenciais quantitativas

## **Regressão linear simples**
```{r, fig.align='center', fig.dim=c(6,6)}
# teste de normalidade
shapiro.test(da$tam_medio_femur)
```

---

# 7.11 Análises inferenciais quantitativas

## **Regressão linear simples**
```{r, fig.align='center', fig.dim=c(6,6)}
# teste de normalidade
plot(density(da$tam_medio_femur))
```

---

# 7.11 Análises inferenciais quantitativas

## **Regressão linear simples**
```{r}
# modelo linear simples
mo.lm.log10 <- lm(log10(tam_medio_femur) ~ pct_flo,
            data = da)
mo.lm.log10
```

---

# 7.11 Análises inferenciais quantitativas

## **Regressão linear simples**
### Resumo do modelo

```{r}
# resumo
summary(mo.lm.log10)
```

---

# 7.11 Análises inferenciais quantitativas

## **Regressão linear simples**
```{r}
# parametros
tidy(mo.lm.log10)
```

---

# 7.11 Análises inferenciais quantitativas

## **Regressão linear múltipla**
```{r}
# valores ajustados e residuos
augment(mo.lm.log10)
```

---

# 7.11 Análises inferenciais quantitativas

## **Regressão linear múltipla**
```{r}
# coeficiente de determinacap
glance(mo.lm.log10)
```

---

# 7.11 Análises inferenciais quantitativas

## **Diagnóstico da regressão**
### 1 Os resíduos precisam ter **distribuição normal**, com média 0 e desvio padrao 1
```{r}
# distribuição normal dos residuos
mean(mo.lm.log10$residuals)
sd(mo.lm.log10$residuals)
```

---

# 7.11 Análises inferenciais quantitativas

## **Diagnóstico da regressão**
```{r}
# distribuição normal dos residuos
shapiro.test(mo.lm.log10$residuals)
```

---

# 7.11 Análises inferenciais quantitativas

## **Diagnóstico da regressão**
```{r, fig.align='center', fig.dim=c(6,6)}
# distribuição normal dos residuos
plot(density(mo.lm.log10$residuals))
```

---

# 7.11 Análises inferenciais quantitativas

## **Diagnóstico da regressão**
```{r, fig.align='center', fig.dim=c(5,5)}
# qqplot
library(car)
qqPlot(mo.lm.log10$residuals)
```

---

# 7.11 Análises inferenciais quantitativas

## **Diagnóstico da regressão**
### 2 A variância dos resíduos é homogênea ao longo de X
```{r, fig.align='center', fig.dim=c(5,5)}
# distribuição normal dos resíduos
plot(da$pct_flo, mo.lm.log10$residuals)
abline(h = 0, col = "red")
```

---

class: inverse, center, middle

# Transformação falhou miseravelmente...

---

class: inverse, center, middle

# Mas o mundo não é tão simples e podemos ter várias variáveis preditoras...

---

class: inverse, center, middle

# Para isso, **Regressão linear múltipla**

---

# 7.11 Análises inferenciais quantitativas

## **Regressão linear múltipla**
```{r}
# modelo linear multiplo
mo.lm.mu <- lm(tam_medio_femur ~ pct_flo + conect,
            data = da)
mo.lm.mu
```

---

# 7.11 Análises inferenciais quantitativas

## **Regressão linear múltipla**
### 1. Parâmetros e testes-t dos parâmetros
### 2. Parâmetros dos modelo (F, df e p)
### 3. Coeficiente de determinação ajustado (adjR<sup>2</sup>)
```{r}
# resumo do modelo
summary(mo.lm.mu)
```

---

# 7.11 Análises inferenciais quantitativas

## **Regressão linear múltipla**
```{r}
# parametros
tidy(mo.lm.mu)
```

---

# 7.11 Análises inferenciais quantitativas

## **Regressão linear múltipla**
```{r}
# valores ajustados e residuos
augment(mo.lm.mu)
```

---

# 7.11 Análises inferenciais quantitativas

## **Regressão linear múltipla**
```{r}
# coeficiente de determinacao
glance(mo.lm)
```
--
```{r}
# coeficiente de determinacao
glance(mo.lm.mu)
```

---

# 7.11 Análises inferenciais quantitativas

## **Regressão linear múltipla**
### plot
```{r, fig.align='center', fig.dim=c(12,5)}
library(car)
avPlots(mo.lm.mu)
```

---

# 7.11 Análises inferenciais quantitativas

## **Regressão linear múltipla**
### **Diagnóstico da regressão**

```{r, fig.align='center', fig.dim=c(12,4)}
par(mfrow  = c(1, 4))
plot(mo.lm.mu)
```

---

class: inverse, middle, center

# Dúvidas?

---

class: clear, middle

## Maurício H. Vancine

<br>

Contatos:

|                                                                                                            |                                   |
| :--------------------------------------------------------------------------------------------------------- | :-------------------------------- |
| <a href="mailto:mauricio.vancine@gmail.com">.RUred[<i class="fa fa-paper-plane fa-fw"></i>]               | mauricio.vancine@gmail.com       |
| <a href="mauriciovancine.github.io">.RUred[<i class="fa fa-link fa-fw"></i>] | mauriciovancine.github.io |
| <a href="http://twitter.com/mauriciovancine">.RUred[<i class="fa fa-twitter fa-fw"></i>]                          | @mauriciovancine                         |
| <a href="http://gitlab.com/mauriciovancine">.RUred[<i class="fa fa-gitlab fa-fw"></i>]                          | @mauriciovancine                       |
| <a href="http://github.com/mauriciovancine">.RUred[<i class="fa fa-github fa-fw"></i>]                          | @mauriciovancine                       |

Slides criados via pacote [xaringan](https://github.com/yihui/xaringan) e tema [Metropolis](https://github.com/pat-s/xaringan-metropolis).