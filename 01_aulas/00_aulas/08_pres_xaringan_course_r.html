<!DOCTYPE html>
<html>
  <head>
    <title>Introdução à linguagem R:</title>
    <meta charset="utf-8">
    <meta name="author" content="Maurício H. Vancine" />
    <link href="libs/remark-css/metropolis.css" rel="stylesheet" />
    <script src="https://use.fontawesome.com/5235085b15.js"></script>
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Introdução à linguagem R: <br><br>
## 8 Modelos Lineares Generalizados (GLM)<br><br><br>
### Maurício H. Vancine
### 15/01/2019

---




class: clear, center, middle
background-image: url(https://raw.githubusercontent.com/mauriciovancine/curso-r/master/imagens/plot_poiss.png)
background-size: 700px
background-position: 50% 50%

---

# 8 Modelos Lineares Generalizados (GLM)
## Tópicos
8.1 Modelos Lineares (LM)
&lt;br&gt;
8.2 Modelos Lineares Generalizados (GLM)
&lt;br&gt;
8.3 Famílias de distribuição (Gaussiana, Binomial, Poisson)
&lt;br&gt;
8.4 Funções de ligação
&lt;br&gt;
8.5 Ajuste dos modelos
&lt;br&gt;
8.6 Ajuste dos modelos no R
&lt;br&gt;
8.7 Seleção de modelos (AIC)

---

background-image: url(https://raw.githubusercontent.com/mauriciovancine/curso-r/master/imagens/glm_livro.png)
background-size: 250px
background-position: 50% 70%

# 8 Modelos Lineares Generalizados (GLM)

## Livros

### **Modelos Lineares Generalizados e Extensões (2013)**

### Gauss Moutinho Cordeiro e Clarice G.B. Demétrio

&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;

[*] http://www.esalq.usp.br/departamentos/lce/arquivos/aulas/2013/LCE5868/livro.pdf

---

background-image: url(https://press.princeton.edu/sites/default/files/styles/large/public/covers/9780691125220_0.png?itok=3jLmBQjA)
background-size: 250px
background-position: 50% 70%

# 8 Modelos Lineares Generalizados (GLM)

## Livros

### **Ecological Models and Data in R (2008)**

### Ben Bolker

&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;

[*] https://ms.mcmaster.ca/~bolker/emdbook/index.html

---

background-image: url(https://images.tandf.co.uk/common/jackets/amazon/978113874/9781138741515.jpg)
background-size: 220px
background-position: 50% 65%

# 8 Modelos Lineares Generalizados (GLM)

## Livros

### **An Introduction to Generalized Linear Models (2018)**

### Annette J. Dobson e Adrian G. Barnett

&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;

[*] https://www.crcpress.com/An-Introduction-to-Generalized-Linear-Models/Dobson-Barnett/p/book/9781138741515

---

background-image: url(https://images.springer.com/sgw/books/medium/9780387874579.jpg)
background-size: 200px
background-position: 50% 75%

# 8 Modelos Lineares Generalizados (GLM)

## Livros

### **Mixed Effects Models and Extensions in Ecology with R**&lt;sup&gt;*&lt;/sup&gt;

### Alain Zuur, Elena Ieno, Neil Walker, Anatoly Saveliev e Graham Smith

&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;

[*] http://highstat.com/index.php/mixed-effects-models-and-extensions-in-ecology-with-r

---

# 8.1 Modelos Lineares (LM)

## Modelos Lineares (LM)

### Nossas análises nem sempre atendem aos **pressupostos** dos **modelos lineares**

&lt;br&gt;

--

### 1. Linearidade
### 2. Independência
### **3. Homocedasticidade**
### **4. Normalidade**

---

# 8.2 Modelos Lineares Generalizados (GLM)

### Os GLMs foram propostos por **Nelder and Wedderburn** (1972) como uma extensão do modelo linear normal

--

### São modelos para análise de dados em que a **variância não é constante** ou o **erro do modelo** não tem uma **distribuição gaussiana (normal)**

--

### A modelagem não é feita de forma direta, sendo necessário escolher uma **família de distribuição** da **variável Y**

--

### Eles possibilitam utilizar **outras distribuições** para os erros e uma **função de ligação** que relaciona a **variável resposta (X)** à combinação linear das **variáveis preditoras (Y)**

---

# 8.2 Modelos Lineares Generalizados (GLM)

## Devemos considerar o **uso dos GLMs** quando a **variável resposta (Y)** geralmente for:

&lt;br&gt;&lt;br&gt;

### contagem expressa em proporções (porcentagem)
### contagens simples (abundância de espécies)
### variáveis binárias (morto ou vivo)
### tempo para o evento ocorrer (modelos de sobrevivência)

---

# 8.2 Modelos Lineares Generalizados (GLM)

## Ao utilizar um GLM, devemos definir:

&lt;br&gt;&lt;br&gt;&lt;br&gt;

### 1. o comportamento (distribuição) da variável resposta (Y)

--

### 2. as variáveis preditoras (X)

--

### 3. a **função de ligação** que irá ligar as variáveis preditoras (X) à variável resposta (Y)

---

# 8.3 Famílias de distribuição

## Tipos de resposta e distribuições

&lt;br&gt;&lt;br&gt;&lt;br&gt;

### **Medidas**: distribuição Gaussiana

### **Binária**: distribuição Binomial

### **Contagem**: distribuição de Poisson

---

background-image: url(https://raw.githubusercontent.com/mauriciovancine/curso-r/master/imagens/tabela_glm.png)
background-size: 700px
background-position: 50% 50%

# 8.4 Funções de ligação

---

# 8.5 Ajuste dos modelos

&lt;br&gt;&lt;br&gt;

## Inferência baseada na teoria assintótica de **máxima verossimilhança**

--
&lt;br&gt;

## Não tem **valor de p** nem **R&lt;sup&gt;2&lt;/sup&gt;** para o modelo!!!

--

&lt;br&gt;

## Mas podemos **calcular** valores ajustados

---

background-image: url(https://raw.githubusercontent.com/mauriciovancine/curso-r/master/imagens/maxi1.png)
background-size: 600px
background-position: 50% 50%

# 8.5 Ajuste dos modelos

---

background-image: url(https://raw.githubusercontent.com/mauriciovancine/curso-r/master/imagens/maxi2.png)
background-size: 600px
background-position: 50% 50%

# 8.5 Ajuste dos modelos

---

# 8.6 Ajuste dos modelos no R

### No R, utilizamos a função 
`glm()`

--

### Fórmula: 
`formula: y ∼ x1 + x2 + ... `

--

### Famílias de distribuiao
`family: gaussian(link = identity)`

`family: binomial(link = logit)`

`family: poisson(link = log)`

--

### Verificar as estatísticas dos modelos
`summary()`

---

background-image: url(https://www.rstudio.com/wp-content/uploads/2014/04/broom.png)
background-size: 400px
background-position: 50% 70%

# 8.6 Ajuste dos modelos no R

## Podemos ainda retornar usando o pacote `broom`

`tidy()`

`augment()`

`glance()`

---

background-image: url(https://octodex.github.com/images/octobiwan.jpg)
background-size: 250px
background-position: 50% 90%

# Dados do GitHub

## Dados do **GitHub**


`https://github.com/mauriciovancine/curso-r/tree/master/data`


`dados_anfíbios.csv -&gt; Raw -&gt; Copia o link`


```r
library(tidyverse)

da &lt;- read_csv("https://raw.githubusercontent.com/mauriciovancine/curso-r/master/data/dados_anfibios.csv")
da
```

---

# 8.6 Ajuste dos modelos no R

## GLM - gaussiano

```r
mo.glm.ga &lt;- glm(tam_medio_femur ~ pct_flo,
                 family = gaussian, 
                 data = da)
mo.glm.ga
```

```
## 
## Call:  glm(formula = tam_medio_femur ~ pct_flo, family = gaussian, data = da)
## 
## Coefficients:
## (Intercept)      pct_flo  
##    1.229914    -0.001748  
## 
## Degrees of Freedom: 20 Total (i.e. Null);  19 Residual
## Null Deviance:	    0.08263 
## Residual Deviance: 0.04482 	AIC: -63.55
```

---

# 8.6 Ajuste dos modelos no R

```r
# coeficientes
library(broom)
tidy(mo.glm.ga)
```

```
## # A tibble: 2 x 5
##   term        estimate std.error statistic  p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)  1.23     0.0244       50.3  1.10e-21
## 2 pct_flo     -0.00175  0.000437     -4.00 7.60e- 4
```

---

# 8.6 Ajuste dos modelos no R

```r
# valores ajustados e residuos
augment(mo.glm.ga)
```

```
## # A tibble: 21 x 9
##    tam_medio_femur pct_flo .fitted .se.fit  .resid   .hat .sigma .cooksd
##              &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
##  1            1.17      46    1.15  0.0108  0.0225 0.0492 0.0496 0.00584
##  2            1.17      57    1.13  0.0110  0.0407 0.0511 0.0489 0.0200 
##  3            1.15      78    1.09  0.0160  0.0604 0.109  0.0476 0.106  
##  4            1.08      71    1.11  0.0139 -0.0308 0.0818 0.0493 0.0195 
##  5            1.16      59    1.13  0.0112  0.0302 0.0536 0.0494 0.0116 
##  6            1.26      12    1.21  0.0198  0.0501 0.167  0.0482 0.128  
##  7            1.01      68    1.11  0.0131 -0.105  0.0726 0.0428 0.197  
##  8            1.09      53    1.14  0.0107 -0.0473 0.0482 0.0486 0.0252 
##  9            1.16      49    1.14  0.0106  0.0207 0.0478 0.0496 0.00481
## 10            1.20      29    1.18  0.0141  0.0178 0.0847 0.0497 0.00678
## # … with 11 more rows, and 1 more variable: .std.resid &lt;dbl&gt;
```

---

class: inverse, center, middle

# Para os amantes do **p-value**...

---

# 8.6 Ajuste dos modelos no R

```r
# valor p de um modelo pelo teste da razão da verossimilhança
library(lmtest)
lrtest(mo.glm.ga)
```

```
## Likelihood ratio test
## 
## Model 1: tam_medio_femur ~ pct_flo
## Model 2: tam_medio_femur ~ 1
##   #Df LogLik Df  Chisq Pr(&gt;Chisq)    
## 1   3 34.773                         
## 2   2 28.350 -1 12.845  0.0003383 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

---

# 8.6 Ajuste dos modelos no R

```r
# coeficiente de determinacao
glance(mo.glm.ga)
```

```
## # A tibble: 1 x 7
##   null.deviance df.null logLik   AIC   BIC deviance df.residual
##           &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt;
## 1        0.0826      20   34.8 -63.5 -60.4   0.0448          19
```

---

# 8.6 Ajuste dos modelos no R

```r
# coeficiente de determinacao
library(rcompanion)
nagelkerke(mo.glm.ga)
```

```
## $Models
##                                                      
## Model: "glm, tam_medio_femur ~ pct_flo, gaussian, da"
## Null:  "glm, tam_medio_femur ~ 1, gaussian, da"      
## 
## $Pseudo.R.squared.for.model.vs.null
##                              Pseudo.R.squared
## McFadden                           -0.2265460
## Cox and Snell (ML)                  0.4575620
## Nagelkerke (Cragg and Uhler)       -0.0329652
## 
## $Likelihood.ratio.test
##  Df.diff LogLik.diff  Chisq    p.value
##       -1     -6.4227 12.845 0.00033832
## 
## $Number.of.observations
##          
## Model: 21
## Null:  21
## 
## $Messages
## [1] "Note: For models fit with REML, these statistics are based on refitting with ML"
## 
## $Warnings
## [1] "None"
```

---

# 8.6 Ajuste dos modelos no R
## Plot

```r
ggplot(data = da) +
  aes(x = pct_flo, y = tam_medio_femur) +
* stat_smooth(method = "glm", method.args = list(family = "gaussian"),
*             col = "black", level = .95) +
  geom_point(shape = 21, size = 5, col = "black", 
             fill = "forestgreen", alpha = .8) +
  theme_classic() +
  labs(x = "Porcentagem de floresta (%)",
          y = "Tamanho do fêmur") +
  theme(axis.title = element_text(size = 24),
        axis.text.x = element_text(size = 20),
        axis.text.y = element_text(size = 20),
        legend.title = element_text(size = 14),
        legend.text = element_text(size = 12))
```

---

# 8.6 Ajuste dos modelos no R
## Plot
&lt;img src="08_pres_xaringan_course_r_files/figure-html/unnamed-chunk-9-1.png" style="display: block; margin: auto;" /&gt;

---

# 8.6 Ajuste dos modelos no R

## Pressupostos dos modelos

```r
# pressupostos do modelo
par(mfrow  = c(2, 2))
plot(mo.glm.ga)
```

&lt;img src="08_pres_xaringan_course_r_files/figure-html/unnamed-chunk-10-1.png" style="display: block; margin: auto;" /&gt;

---

# 8.6 Ajuste dos modelos no R

## GLM - binomial ou Regressão logística

```r
mo.glm.bi &lt;- glm(pres_inv ~ pct_flo,
                 family = binomial("logit"), 
                 data = da)
mo.glm.bi
```

```
## 
## Call:  glm(formula = pres_inv ~ pct_flo, family = binomial("logit"), 
##     data = da)
## 
## Coefficients:
## (Intercept)      pct_flo  
##    -13.1216       0.2306  
## 
## Degrees of Freedom: 20 Total (i.e. Null);  19 Residual
## Null Deviance:	    29.06 
## Residual Deviance: 9.04 	AIC: 13.04
```

---

# 8.6 Ajuste dos modelos no R

```r
# coeficientes
library(broom)
tidy(mo.glm.bi)
```

```
## # A tibble: 2 x 5
##   term        estimate std.error statistic p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
## 1 (Intercept)  -13.1       7.40      -1.77  0.0761
## 2 pct_flo        0.231     0.125      1.84  0.0661
```

---

# 8.6 Ajuste dos modelos no R

```r
# valores ajustados e residuos
augment(mo.glm.bi)
```

```
## # A tibble: 21 x 9
##    pres_inv pct_flo  .fitted .se.fit   .resid    .hat .sigma .cooksd
##       &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
##  1        0      46  -2.51     1.79  -0.395   0.221    0.701 1.47e-2
##  2        0      57   0.0224   0.863 -1.19    0.186    0.637 1.44e-1
##  3        1      78   4.86     2.58   0.124   0.0506   0.708 2.16e-4
##  4        1      71   3.25     1.77   0.276   0.113    0.705 2.78e-3
##  5        1      59   0.484    0.842  0.980   0.167    0.662 7.43e-2
##  6        0      12 -10.4      5.90  -0.00798 0.00111  0.709 1.77e-8
##  7        1      68   2.56     1.45   0.386   0.141    0.702 7.36e-3
##  8        1      53  -0.900    1.09   1.58    0.245    0.565 5.29e-1
##  9        0      49  -1.82     1.46  -0.547   0.257    0.693 3.76e-2
## 10        0      29  -6.43     3.80  -0.0566  0.0232   0.709 1.95e-5
## # … with 11 more rows, and 1 more variable: .std.resid &lt;dbl&gt;
```

---

# 8.6 Ajuste dos modelos no R

```r
# valor p de um modelo pelo teste da razão da verossimilhanca
lrtest(mo.glm.bi)
```

```
## Likelihood ratio test
## 
## Model 1: pres_inv ~ pct_flo
## Model 2: pres_inv ~ 1
##   #Df   LogLik Df  Chisq Pr(&gt;Chisq)    
## 1   2  -4.5199                         
## 2   1 -14.5323 -1 20.025  7.644e-06 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

---

# 8.6 Ajuste dos modelos no R

```r
# coeficiente de determinacao
glance(mo.glm.bi)
```

```
## # A tibble: 1 x 7
##   null.deviance df.null logLik   AIC   BIC deviance df.residual
##           &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt;
## 1          29.1      20  -4.52  13.0  15.1     9.04          19
```

---

# 8.6 Ajuste dos modelos no R

```r
# coeficiente de determinacao
nagelkerke(mo.glm.bi)
```

```
## $Models
##                                                          
## Model: "glm, pres_inv ~ pct_flo, binomial(\"logit\"), da"
## Null:  "glm, pres_inv ~ 1, binomial(\"logit\"), da"      
## 
## $Pseudo.R.squared.for.model.vs.null
##                              Pseudo.R.squared
## McFadden                             0.688978
## Cox and Snell (ML)                   0.614635
## Nagelkerke (Cragg and Uhler)         0.820134
## 
## $Likelihood.ratio.test
##  Df.diff LogLik.diff  Chisq    p.value
##       -1     -10.012 20.025 7.6443e-06
## 
## $Number.of.observations
##          
## Model: 21
## Null:  21
## 
## $Messages
## [1] "Note: For models fit with REML, these statistics are based on refitting with ML"
## 
## $Warnings
## [1] "None"
```

---

# 8.6 Ajuste dos modelos no R
## Plot

```r
ggplot(data = da) +
  aes(x = pct_flo, y = pres_inv) +
* stat_smooth(method = "glm", method.args = list(family = "binomial"),
*             col = "black", level = .95) +
  geom_point(shape = 21, size = 5, col = "black", fill = "red", alpha = .8) +
  theme_classic() +
  labs(x = "Porcentagem de floresta (%)",
          y = "Espécie invasora") +
  theme(axis.title = element_text(size = 24),
        axis.text.x = element_text(size = 20),
        axis.text.y = element_text(size = 20),
        legend.title = element_text(size = 14),
        legend.text = element_text(size = 12))
```

---

# 8.6 Ajuste dos modelos no R
## Plot
&lt;img src="08_pres_xaringan_course_r_files/figure-html/unnamed-chunk-18-1.png" style="display: block; margin: auto;" /&gt;

---

# 8.6 Ajuste dos modelos no R

## Pressupostos dos modelos

```r
# pressupostos do modelo
par(mfrow  = c(2, 2))
plot(mo.glm.bi)
```

&lt;img src="08_pres_xaringan_course_r_files/figure-html/unnamed-chunk-19-1.png" style="display: block; margin: auto;" /&gt;

---

# 8.6 Ajuste dos modelos no R

## GLM - poisson

```r
mo.glm.po &lt;- glm(n_sp ~ pct_flo,
                 family = poisson, 
                 data = da)
mo.glm.po
```

```
## 
## Call:  glm(formula = n_sp ~ pct_flo, family = poisson, data = da)
## 
## Coefficients:
## (Intercept)      pct_flo  
##     1.37641      0.01225  
## 
## Degrees of Freedom: 20 Total (i.e. Null);  19 Residual
## Null Deviance:	    17.83 
## Residual Deviance: 4.697 	AIC: 89.29
```

---

# 8.6 Ajuste dos modelos no R

```r
# coeficientes
tidy(mo.glm.po)
```

```
## # A tibble: 2 x 5
##   term        estimate std.error statistic  p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)   1.38     0.214        6.44 1.22e-10
## 2 pct_flo       0.0123   0.00347      3.53 4.19e- 4
```

---

# 8.6 Ajuste dos modelos no R

```r
# valores ajustados e residuos
augment(mo.glm.po)
```

```
## # A tibble: 21 x 9
##     n_sp pct_flo .fitted .se.fit  .resid   .hat .sigma   .cooksd .std.resid
##    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
##  1     7      46    1.94  0.0880  0.0157 0.0538  0.511   7.46e-6     0.0162
##  2     6      57    2.07  0.0788 -0.727  0.0495  0.480   1.32e-2    -0.746 
##  3    11      78    2.33  0.107   0.216  0.117   0.508   3.60e-3     0.230 
##  4     8      71    2.25  0.0922 -0.485  0.0803  0.497   1.06e-2    -0.506 
##  5     7      59    2.10  0.0790 -0.416  0.0510  0.501   4.67e-3    -0.427 
##  6     3      12    1.52  0.176  -0.792  0.142   0.469   5.29e-2    -0.855 
##  7     9      68    2.21  0.0872 -0.0368 0.0693  0.511   5.41e-5    -0.0382
##  8     9      53    2.03  0.0802  0.500  0.0487  0.496   7.15e-3     0.513 
##  9     8      49    1.98  0.0838  0.286  0.0508  0.506   2.38e-3     0.293 
## 10     6      29    1.73  0.126   0.146  0.0894  0.510   1.17e-3     0.153 
## # … with 11 more rows
```

---

# 8.6 Ajuste dos modelos no R

```r
# valor p de um modelo pelo teste da razão da verossimilhanca
lrtest(mo.glm.po)
```

```
## Likelihood ratio test
## 
## Model 1: n_sp ~ pct_flo
## Model 2: n_sp ~ 1
##   #Df  LogLik Df  Chisq Pr(&gt;Chisq)    
## 1   2 -42.646                         
## 2   1 -49.215 -1 13.138  0.0002893 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

---

# 8.6 Ajuste dos modelos no R

```r
# coeficiente de determinacao
glance(mo.glm.po)
```

```
## # A tibble: 1 x 7
##   null.deviance df.null logLik   AIC   BIC deviance df.residual
##           &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt;
## 1          17.8      20  -42.6  89.3  91.4     4.70          19
```

---

# 8.6 Ajuste dos modelos no R

```r
# coeficiente de determinacao
nagelkerke(mo.glm.po)
```

```
## $Models
##                                          
## Model: "glm, n_sp ~ pct_flo, poisson, da"
## Null:  "glm, n_sp ~ 1, poisson, da"      
## 
## $Pseudo.R.squared.for.model.vs.null
##                              Pseudo.R.squared
## McFadden                             0.133476
## Cox and Snell (ML)                   0.465074
## Nagelkerke (Cragg and Uhler)         0.469398
## 
## $Likelihood.ratio.test
##  Df.diff LogLik.diff  Chisq    p.value
##       -1     -6.5691 13.138 0.00028934
## 
## $Number.of.observations
##          
## Model: 21
## Null:  21
## 
## $Messages
## [1] "Note: For models fit with REML, these statistics are based on refitting with ML"
## 
## $Warnings
## [1] "None"
```

---

# 8.6 Ajuste dos modelos no R
## Plot

```r
ggplot(data = da) +
  aes(x = pct_flo, y = n_sp) +
* stat_smooth(method = "glm", method.args = list(family = "poisson"),
*             col = "black", level = .95) +
  geom_point(shape = 21, size = 5, col = "black", 
             fill = "blue", alpha = .8) +
  theme_classic() +
  labs(x = "Porcentagem de floresta (%)",
          y = "Número de espécies") +
  theme(axis.title = element_text(size = 24),
        axis.text.x = element_text(size = 20),
        axis.text.y = element_text(size = 20),
        legend.title = element_text(size = 14),
        legend.text = element_text(size = 12))
```

---

# 8.6 Ajuste dos modelos no R
## Plot
&lt;img src="08_pres_xaringan_course_r_files/figure-html/unnamed-chunk-27-1.png" style="display: block; margin: auto;" /&gt;

---

# 8.6 Ajuste dos modelos no R

## Pressupostos dos modelos

```r
# pressupostos do modelo
par(mfrow  = c(2, 2))
plot(mo.glm.ga)
```

&lt;img src="08_pres_xaringan_course_r_files/figure-html/unnamed-chunk-28-1.png" style="display: block; margin: auto;" /&gt;

---

class: inverse, center, middle

# Agora uma quebra de paradigma!

---

class: inverse, center, middle

# Vamos testar várias hipóteses ao mesmo tempo!

---

class: inverse, center, middle
background-image: url(https://media.giphy.com/media/EvWx1BeeRyyJi/giphy.gif)
background-size: 500px
background-position: 50% 50%

---

background-image: url(https://wikimedia.org/api/rest_v1/media/math/render/svg/5c6aebcc42fdb3b423867af9b3ce63d4e5b70d4b)
background-size: 400px
background-position: 50% 80%

# 8.7 Seleção de modelos (AIC)

## Seleção de modelos, por AIC (Akaike Criterion Information)

### Ranqueamento do modelo modelo mais plausível

--

### Usa-se geralmente os valores de AICc (para medidas pequenas)

&lt;BR&gt;

`AIC = 2K – 2 * ln(L), onde k = número de parâmetros estimados e L = máximo da função de verossimilhança`

---

# 8.7 Seleção de modelos (AIC)

## Critérios de seleção, segundo (Burnham e Anderson 2002):

&lt;br&gt;&lt;br&gt;

## **ΔAICc &lt; 2.0** (plausibilidade)
 
## **wAICc &gt; 1.0** (peso no ranqueamento)

&lt;br&gt; 

### Todos os modelos com valores de **ΔAICc &lt; 2.0** e **wAICc &gt; 1.0** serão igualmente plausíveis
---

# 8.7 Seleção de modelos (AIC)

## Criar modelos segundo nossas hipóteses concorrente, inclusive o modelo nulo [glm(Y ~ 1)]

```r
mo0 &lt;- glm(n_sp ~ 1, data = da, family = poisson)
mo1 &lt;- glm(n_sp ~ pct_flo, data = da, family = poisson)
mo2 &lt;- glm(n_sp ~ conect, data = da, family = poisson)
mo3 &lt;- glm(n_sp ~ matriz, data = da, family = poisson)
mo4 &lt;- glm(n_sp ~ pct_flo + conect, data = da, family = poisson)
mo5 &lt;- glm(n_sp ~ pct_flo + conect + matriz, data = da, family = poisson)
```

---

# 8.7 Seleção de modelos (AIC)

```r
library(bbmle)
aic &lt;- ICtab(mo0, mo1, mo2, mo3, mo4, mo5, 
             type = "AICc",
             weights = TRUE,
             delta = TRUE,
             logLik = TRUE,
             sort = TRUE,
             nobs = nrow(da))

aic
```

```
##     dLogLik dAICc df weight
## mo1  6.6     0.0  2  0.5786
## mo2  5.8     1.6  2  0.2637
## mo4  6.6     2.7  3  0.1485
## mo5  6.6     9.3  5  0.0057
## mo0  0.0    10.7  1  0.0028
## mo3  1.4    13.2  3  &lt;0.001
```

---

class: inverse, middle, center

# Dúvidas?

---

class: inverse, middle, center

# Grato pela oportunidade e confiança nesses dias!

---

class: clear, middle

## Maurício H. Vancine

&lt;br&gt;

Contatos:

|                                                                                                            |                                   |
| :--------------------------------------------------------------------------------------------------------- | :-------------------------------- |
| &lt;a href="mailto:mauricio.vancine@gmail.com"&gt;.RUred[&lt;i class="fa fa-paper-plane fa-fw"&gt;&lt;/i&gt;]               | mauricio.vancine@gmail.com       |
| &lt;a href="mauriciovancine.github.io"&gt;.RUred[&lt;i class="fa fa-link fa-fw"&gt;&lt;/i&gt;] | mauriciovancine.github.io |
| &lt;a href="http://twitter.com/mauriciovancine"&gt;.RUred[&lt;i class="fa fa-twitter fa-fw"&gt;&lt;/i&gt;]                          | @mauriciovancine                         |
| &lt;a href="http://gitlab.com/mauriciovancine"&gt;.RUred[&lt;i class="fa fa-gitlab fa-fw"&gt;&lt;/i&gt;]                          | @mauriciovancine                       |
| &lt;a href="http://github.com/mauriciovancine"&gt;.RUred[&lt;i class="fa fa-github fa-fw"&gt;&lt;/i&gt;]                          | @mauriciovancine                       |

Slides criados via pacote [xaringan](https://github.com/yihui/xaringan) e tema [Metropolis](https://github.com/pat-s/xaringan-metropolis).
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightLines": true,
"countIncrementalSlides": true
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function() {
  var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})();</script>

<script>
(function() {
  var i, text, code, codes = document.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
})();
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
